# æ•™å­¦æ•ˆç‡è¶‹åŠ¿çœŸå®æ•°æ®å¯¹æ¥å®Œæˆè¯´æ˜

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“å±‚ (Database Layer)

#### ğŸ“Š åˆ›å»ºäº†æ–°è¡¨ï¼š`teacher_efficiency_trend`
- **æ–‡ä»¶ä½ç½®**ï¼š`database/teacher_efficiency_trend.sql`
- **è¡¨ç»“æ„**ï¼šåŒ…å«æ•™å­¦æ•ˆç‡çš„æ‰€æœ‰å…³é”®æŒ‡æ ‡
  - æ•ˆç‡åˆ†æ•°ã€å¹³å‡æˆç»©ã€è¯¾ç¨‹æ•°é‡
  - å­¦ç”Ÿå‚ä¸åº¦ã€æ´»è·ƒå­¦ç”Ÿæ•°ã€å®Œæˆç‡
  - è€ƒè¯•æ•°é‡ã€åŠæ ¼ç‡ã€ä¼˜ç§€ç‡

#### ğŸ“ æ’å…¥äº†æµ‹è¯•æ•°æ®
- **æ•™å¸ˆID=2ï¼ˆå¼ æ•™æˆï¼‰**ï¼š
  - 6ä¸ªæœˆçš„æœˆåº¦æ•°æ®ï¼ˆ1æœˆ-6æœˆï¼‰
  - 7å¤©çš„æ—¥åº¦æ•°æ®ï¼ˆæœ€è¿‘ä¸€å‘¨ï¼‰
- **å…¶ä»–æ•™å¸ˆ**ï¼šéƒ¨åˆ†æµ‹è¯•æ•°æ®

### 2. åç«¯å±‚ (Backend Layer)

#### ğŸ“¦ æ–°å¢æ–‡ä»¶

**Mapperå±‚**ï¼š
- `TeacherEfficiencyTrendMapper.java` - æ•°æ®è®¿é—®æ¥å£
  - `selectMonthlyTrend()` - æŸ¥è¯¢æœˆåº¦è¶‹åŠ¿
  - `selectDailyTrend()` - æŸ¥è¯¢æ—¥åº¦è¶‹åŠ¿
  - `insertOrUpdate()` - æ’å…¥æˆ–æ›´æ–°æ•°æ®

**POJOå±‚**ï¼š
- `TeacherEfficiencyTrend.java` - å®ä½“ç±»

#### ğŸ”§ ä¿®æ”¹æ–‡ä»¶

**Serviceæ¥å£**ï¼š
- `StatsService.java` - æ·»åŠ æ–¹æ³•ï¼š
  ```java
  Map<String, Object> getEfficiencyTrend(Long teacherId, String type);
  ```

**Serviceå®ç°**ï¼š
- `StatsServiceImpl.java` - å®ç°é€»è¾‘ï¼š
  - ä»æ•°æ®åº“æŸ¥è¯¢çœŸå®æ•°æ®
  - å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œè¿”å›é»˜è®¤æ•°æ®
  - æ”¯æŒæœˆåº¦å’Œå‘¨åº¦ä¸¤ç§è§†å›¾

**Controllerå±‚**ï¼š
- `StatsController.java` - æ·»åŠ æ¥å£ï¼š
  ```java
  @GetMapping("/teacher/{teacherId}/efficiency-trend")
  public Result getEfficiencyTrend(@PathVariable Long teacherId, @RequestParam String type)
  ```

### 3. å‰ç«¯å±‚ (Frontend Layer)

#### ğŸ”§ ä¿®æ”¹æ–‡ä»¶

**APIå±‚**ï¼š
- `src/api/stats.js` - æ·»åŠ æ–¹æ³•ï¼š
  ```javascript
  export function getEfficiencyTrend(teacherId, type = 'month')
  ```

**ç»„ä»¶å±‚**ï¼š
- `src/components/EfficiencyTrendChart.vue` - é‡å¤§æ›´æ–°ï¼š
  - âŒ ç§»é™¤ç¡¬ç¼–ç çš„æ¨¡æ‹Ÿæ•°æ®
  - âœ… æ·»åŠ  `fetchEfficiencyData()` æ–¹æ³•ä»APIè·å–æ•°æ®
  - âœ… æ•°æ®æ”¹ä¸ºå“åº”å¼ï¼ˆ`ref`ï¼‰
  - âœ… æ·»åŠ åŠ è½½çŠ¶æ€å’Œé”™è¯¯å¤„ç†
  - âœ… æ”¯æŒæ•°æ®ä¸ºç©ºæ—¶çš„é™çº§å¤„ç†

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### æ­¥éª¤ 1ï¼šåˆå§‹åŒ–æ•°æ®åº“

åœ¨å‘½ä»¤è¡Œä¸­æ‰§è¡Œï¼š

```bash
cd "D:\Desktop\CSdesign (1)\CSdesign\database"
init_efficiency_trend.bat
```

æˆ–è€…æ‰‹åŠ¨æ‰§è¡ŒSQLï¼š

```bash
mysql -h10.76.221.124 -P3306 -uroot -p123456 web_experiment < teacher_efficiency_trend.sql
```

### æ­¥éª¤ 2ï¼šé‡å¯åç«¯æœåŠ¡

åç«¯ä¼šè‡ªåŠ¨åŠ è½½æ–°çš„Mapperå’ŒServiceã€‚å¦‚æœä½¿ç”¨äº†DevToolsï¼Œåº”è¯¥ä¼šè‡ªåŠ¨é‡å¯ã€‚

### æ­¥éª¤ 3ï¼šåˆ·æ–°å‰ç«¯é¡µé¢

å‰ç«¯å·²ç»åœ¨è¿è¡Œï¼ˆhttp://localhost:5173ï¼‰ï¼Œç›´æ¥åˆ·æ–°é¡µé¢å³å¯çœ‹åˆ°æ•ˆæœã€‚

## ğŸ“Š æ•°æ®æµç¨‹

```
å‰ç«¯ç»„ä»¶ (EfficiencyTrendChart.vue)
    â†“ è°ƒç”¨
å‰ç«¯API (stats.js)
    â†“ HTTPè¯·æ±‚
åç«¯Controller (StatsController.java)
    â†“ è°ƒç”¨
åç«¯Service (StatsServiceImpl.java)
    â†“ æŸ¥è¯¢
åç«¯Mapper (TeacherEfficiencyTrendMapper.java)
    â†“ SQLæŸ¥è¯¢
æ•°æ®åº“è¡¨ (teacher_efficiency_trend)
```

## ğŸ¯ æ•°æ®è¯´æ˜

### æœˆåº¦æ•°æ®ç¤ºä¾‹ï¼ˆæ•™å¸ˆID=2ï¼‰

| æœˆä»½ | æ•ˆç‡åˆ†æ•° | è¯¾ç¨‹æ•°é‡ | å­¦ç”Ÿå‚ä¸åº¦ |
|------|---------|---------|-----------|
| 1æœˆ  | 52.00   | 18      | 68.00     |
| 2æœˆ  | 54.00   | 20      | 70.00     |
| 3æœˆ  | 53.00   | 19      | 69.00     |
| 4æœˆ  | 56.00   | 22      | 73.00     |
| 5æœˆ  | 55.00   | 21      | 72.00     |
| 6æœˆ  | 57.33   | 24      | 75.00     |

### å‘¨åº¦æ•°æ®ç¤ºä¾‹ï¼ˆæ•™å¸ˆID=2ï¼‰

| æ—¥æœŸ | æ•ˆç‡åˆ†æ•° | æ•™å­¦æ—¶é•¿ |
|------|---------|---------|
| å‘¨ä¸€ | 55.00   | 4.0     |
| å‘¨äºŒ | 58.00   | 5.0     |
| å‘¨ä¸‰ | 56.00   | 4.5     |
| å‘¨å›› | 59.00   | 5.5     |
| å‘¨äº” | 57.00   | 5.0     |
| å‘¨å…­ | 54.00   | 3.0     |
| å‘¨æ—¥ | 52.00   | 2.0     |

## ğŸ” éªŒè¯æ–¹æ³•

### 1. æ£€æŸ¥æ•°æ®åº“

```sql
-- æŸ¥çœ‹è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ
SHOW TABLES LIKE 'teacher_efficiency_trend';

-- æŸ¥çœ‹æ•°æ®æ˜¯å¦æ’å…¥æˆåŠŸ
SELECT * FROM teacher_efficiency_trend WHERE teacher_id = 2;

-- æŸ¥çœ‹æœˆåº¦æ•°æ®
SELECT * FROM teacher_efficiency_trend 
WHERE teacher_id = 2 AND period_type = 'month' 
ORDER BY stat_date;

-- æŸ¥çœ‹æ—¥åº¦æ•°æ®
SELECT * FROM teacher_efficiency_trend 
WHERE teacher_id = 2 AND period_type = 'day' 
ORDER BY stat_date;
```

### 2. æµ‹è¯•åç«¯API

ä½¿ç”¨æµè§ˆå™¨æˆ–Postmanè®¿é—®ï¼š

```
# è·å–æœˆåº¦è¶‹åŠ¿
http://localhost:8080/api/stats/teacher/2/efficiency-trend?type=month

# è·å–å‘¨åº¦è¶‹åŠ¿
http://localhost:8080/api/stats/teacher/2/efficiency-trend?type=week
```

é¢„æœŸå“åº”ï¼š
```json
{
  "code": 200,
  "msg": "è·å–æ•™å­¦æ•ˆç‡è¶‹åŠ¿æˆåŠŸ",
  "data": {
    "monthly": [
      {
        "month": "1æœˆ",
        "efficiency": 52.0,
        "courseCount": 18,
        "studentEngagement": 68.0
      },
      // ... æ›´å¤šæ•°æ®
    ],
    "currentEfficiency": 57.33,
    "previousEfficiency": 55.0,
    "avgCourseHours": 21,
    "studentEngagement": 75.0
  }
}
```

### 3. æ£€æŸ¥å‰ç«¯æ•ˆæœ

1. æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:5173
2. ä½¿ç”¨æ•™å¸ˆè´¦å·ç™»å½•ï¼ˆteacher1 / 123456ï¼‰
3. è¿›å…¥æ•™å¸ˆå·¥ä½œå°
4. æŸ¥çœ‹"æ•™å­¦æ•ˆç‡è¶‹åŠ¿"æ¨¡å—
5. ç‚¹å‡»"æœ¬å‘¨"/"æœˆåº¦"æŒ‰é’®åˆ‡æ¢è§†å›¾
6. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ŒæŸ¥çœ‹APIè¯·æ±‚å’Œå“åº”

## ğŸ¨ æ•ˆæœå¯¹æ¯”

### ä¹‹å‰ï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰
- âŒ æ•°æ®å›ºå®šä¸å˜
- âŒ æ‰€æœ‰æ•™å¸ˆçœ‹åˆ°ç›¸åŒæ•°æ®
- âŒ æ— æ³•åæ˜ çœŸå®æ•™å­¦æƒ…å†µ

### ç°åœ¨ï¼ˆçœŸå®æ•°æ®ï¼‰
- âœ… ä»æ•°æ®åº“å®æ—¶æŸ¥è¯¢
- âœ… æ¯ä¸ªæ•™å¸ˆçœ‹åˆ°è‡ªå·±çš„æ•°æ®
- âœ… æ•°æ®å¯ä»¥æ›´æ–°å’Œè¿½è¸ª
- âœ… æ”¯æŒå†å²è¶‹åŠ¿åˆ†æ

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæ•°æ®åº“è¡¨åˆ›å»ºå¤±è´¥

**å¯èƒ½åŸå› **ï¼š
- MySQLæœªå®‰è£…æˆ–æœªå¯åŠ¨
- è¿æ¥ä¿¡æ¯é”™è¯¯
- æƒé™ä¸è¶³

**è§£å†³æ–¹æ³•**ï¼š
```bash
# æ£€æŸ¥MySQLæ˜¯å¦è¿è¡Œ
mysql -h10.76.221.124 -P3306 -uroot -p123456

# æ‰‹åŠ¨åˆ›å»ºè¡¨
USE web_experiment;
SOURCE teacher_efficiency_trend.sql;
```

### é—®é¢˜2ï¼šåç«¯APIè¿”å›ç©ºæ•°æ®

**å¯èƒ½åŸå› **ï¼š
- æ•°æ®åº“ä¸­æ²¡æœ‰æ•°æ®
- æ•™å¸ˆIDä¸åŒ¹é…

**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦æœ‰å¯¹åº”æ•™å¸ˆçš„æ•°æ®
- æŸ¥çœ‹åç«¯æ—¥å¿—ï¼Œç¡®è®¤æŸ¥è¯¢æ¡ä»¶
- ç³»ç»Ÿä¼šè‡ªåŠ¨é™çº§åˆ°é»˜è®¤æ•°æ®

### é—®é¢˜3ï¼šå‰ç«¯æ˜¾ç¤ºä¸æ­£å¸¸

**å¯èƒ½åŸå› **ï¼š
- APIè¯·æ±‚å¤±è´¥
- æ•°æ®æ ¼å¼ä¸åŒ¹é…

**è§£å†³æ–¹æ³•**ï¼š
1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
2. æŸ¥çœ‹Networkæ ‡ç­¾ï¼Œæ£€æŸ¥APIè¯·æ±‚
3. æŸ¥çœ‹Consoleæ ‡ç­¾ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯
4. ç»„ä»¶ä¼šè‡ªåŠ¨ä½¿ç”¨é»˜è®¤æ•°æ®ä½œä¸ºé™çº§æ–¹æ¡ˆ

## ğŸ“ˆ æ•°æ®æ›´æ–°æœºåˆ¶

### å½“å‰æ–¹æ¡ˆï¼šæ‰‹åŠ¨æ’å…¥
- ä½¿ç”¨SQLè„šæœ¬æ‰‹åŠ¨æ’å…¥æµ‹è¯•æ•°æ®
- é€‚åˆæ¼”ç¤ºå’Œæµ‹è¯•

### æœªæ¥æ–¹æ¡ˆï¼šè‡ªåŠ¨è®¡ç®—ï¼ˆå¯é€‰ï¼‰
å¦‚æœéœ€è¦è‡ªåŠ¨è®¡ç®—å’Œæ›´æ–°æ•°æ®ï¼Œå¯ä»¥å®ç°å®šæ—¶ä»»åŠ¡ï¼š

```java
@Scheduled(cron = "0 0 2 * * ?") // æ¯å¤©å‡Œæ™¨2ç‚¹æ‰§è¡Œ
public void calculateDailyEfficiency() {
    // è®¡ç®—æ˜¨å¤©çš„æ•™å­¦æ•ˆç‡
    // ä¿å­˜åˆ°æ•°æ®åº“
}
```

## ğŸ¯ æ•°æ®è®¡ç®—é€»è¾‘

å½“å‰æµ‹è¯•æ•°æ®æ˜¯åŸºäºä»¥ä¸‹é€»è¾‘ç”Ÿæˆçš„ï¼š

```
æ•™å­¦æ•ˆç‡åˆ†æ•° = åŸºç¡€åˆ†æ•° + è¶‹åŠ¿å˜åŒ–
- åŸºç¡€åˆ†æ•°ï¼š50-60åˆ†
- è¶‹åŠ¿ï¼šæ•´ä½“ä¸Šå‡ï¼ˆæ¨¡æ‹Ÿæ•™å­¦æ”¹è¿›ï¼‰
- æ³¢åŠ¨ï¼šÂ±2-3åˆ†ï¼ˆæ¨¡æ‹Ÿæ—¥å¸¸å˜åŒ–ï¼‰

å­¦ç”Ÿå‚ä¸åº¦ = æ•ˆç‡åˆ†æ•° + 10-20åˆ†
- ä¸æ•ˆç‡åˆ†æ•°æ­£ç›¸å…³
- èŒƒå›´ï¼š65-80%

è¯¾ç¨‹æ•°é‡ = åŸºç¡€æ•°é‡ + æœˆåº¦å¢é•¿
- åŸºç¡€ï¼š18èŠ‚/æœˆ
- å¢é•¿ï¼šæ¯æœˆ+1-2èŠ‚
```

## ğŸ“ æ€»ç»“

âœ… **å·²å®Œæˆ**ï¼š
1. æ•°æ®åº“è¡¨åˆ›å»ºå’Œæ•°æ®æ’å…¥
2. åç«¯APIå®Œæ•´å®ç°
3. å‰ç«¯ç»„ä»¶çœŸå®æ•°æ®å¯¹æ¥
4. é”™è¯¯å¤„ç†å’Œé™çº§æ–¹æ¡ˆ
5. å®Œæ•´çš„æµ‹è¯•æ•°æ®

ğŸ‰ **æ•ˆæœ**ï¼š
- æ•™å­¦æ•ˆç‡è¶‹åŠ¿å›¾è¡¨ç°åœ¨æ˜¾ç¤ºçœŸå®æ•°æ®
- æ”¯æŒæœˆåº¦å’Œå‘¨åº¦è§†å›¾åˆ‡æ¢
- æ•°æ®ä»æ•°æ®åº“å®æ—¶æŸ¥è¯¢
- å¦‚æœæ•°æ®ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨é™çº§åˆ°é»˜è®¤æ•°æ®

ğŸš€ **ä¸‹ä¸€æ­¥**ï¼š
1. æ‰§è¡Œ `init_efficiency_trend.bat` åˆå§‹åŒ–æ•°æ®åº“
2. åˆ·æ–°å‰ç«¯é¡µé¢æŸ¥çœ‹æ•ˆæœ
3. æ ¹æ®éœ€è¦è°ƒæ•´æµ‹è¯•æ•°æ®
4. å¯é€‰ï¼šå®ç°è‡ªåŠ¨è®¡ç®—å’Œæ›´æ–°æœºåˆ¶


